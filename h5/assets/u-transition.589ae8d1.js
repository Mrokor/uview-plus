import{v as t,o as e,c as i,w as s,k as n,l as a,n as o,p as r,f as u,i as l}from"./index-4f0c5e1d.js";import{m as d,a as h}from"./mixin.d0c91ebc.js";import{_ as c}from"./_plugin-vue_export-helper.1b428a4d.js";const m={props:{show:{type:Boolean,default:()=>uni.$u.props.transition.show},mode:{type:String,default:()=>uni.$u.props.transition.mode},duration:{type:[String,Number],default:()=>uni.$u.props.transition.duration},timingFunction:{type:String,default:()=>uni.$u.props.transition.timingFunction}}},v=t=>({enter:`u-${t}-enter u-${t}-enter-active`,"enter-to":`u-${t}-enter-to u-${t}-enter-active`,leave:`u-${t}-leave u-${t}-leave-active`,"leave-to":`u-${t}-leave-to u-${t}-leave-active`});const p=c({name:"u-transition",data:()=>({inited:!1,viewStyle:{},status:"",transitionEnded:!1,display:!1,classes:""}),emits:["click","beforeEnter","enter","afterEnter","beforeLeave","leave","afterLeave"],computed:{mergeStyle(){const{viewStyle:t,customStyle:e}=this;return{transitionDuration:`${this.duration}ms`,transitionTimingFunction:this.timingFunction,...uni.$u.addStyle(e),...t}}},mixins:[d,h,{methods:{clickHandler(){this.$emit("click")},async vueEnter(){const e=v(this.mode);this.status="enter",this.$emit("beforeEnter"),this.inited=!0,this.display=!0,this.classes=e.enter,await t(),await uni.$u.sleep(20),this.$emit("enter"),this.transitionEnded=!1,this.$emit("afterEnter"),this.classes=e["enter-to"]},async vueLeave(){if(!this.display)return;const e=v(this.mode);this.status="leave",this.$emit("beforeLeave"),this.classes=e.leave,await t(),this.transitionEnded=!1,this.$emit("leave"),setTimeout(this.onTransitionEnd,this.duration),this.classes=e["leave-to"]},onTransitionEnd(){this.transitionEnded||(this.transitionEnded=!0,this.$emit("leave"===this.status?"afterLeave":"afterEnter"),!this.show&&this.display&&(this.display=!1,this.inited=!1))}}},m],watch:{show:{handler(t){t?this.vueEnter():this.vueLeave()},immediate:!0}}},[["render",function(t,d,h,c,m,v){const p=l;return m.inited?(e(),i(p,{key:0,class:a(["u-transition",m.classes]),ref:"u-transition",onClick:t.clickHandler,style:o([v.mergeStyle]),onTouchmove:r(t.noop,["stop","prevent"])},{default:s((()=>[n(t.$slots,"default",{},void 0,!0)])),_:3},8,["onClick","class","style","onTouchmove"])):u("v-if",!0)}],["__scopeId","data-v-9fb7d038"]]);export{p as _};
