import{_ as t}from"./u-avatar.f1b07228.js";import{o as e,c as i,w as s,a as n,n as o,g as r,t as a,h as u,i as l,k as d,l as c,d as h,f as p,p as m,b as f,F as x,r as _,x as g,e as v}from"./index-4f0c5e1d.js";import{r as I}from"./uni-app.es.fcad82c0.js";import{_ as $}from"./u-line.0a9c4e0a.js";import{m as y,a as L}from"./mixin.d0c91ebc.js";import{_ as w}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as b}from"./u-transition.589ae8d1.js";import"./u-icon.e9ca9d71.js";import"./u--text.3ba6596a.js";import"./u-link.2a6cd9b0.js";const C=w({name:"u-index-anchor",mixins:[y,L,{props:{text:{type:[String,Number],default:()=>uni.$u.props.indexAnchor.text},color:{type:String,default:()=>uni.$u.props.indexAnchor.color},size:{type:[String,Number],default:()=>uni.$u.props.indexAnchor.size},bgColor:{type:String,default:()=>uni.$u.props.indexAnchor.bgColor},height:{type:[String,Number],default:()=>uni.$u.props.indexAnchor.height}}}],data:()=>({}),mounted(){this.init()},methods:{init(){const t=uni.$u.$parent.call(this,"u-index-list");if(!t)return uni.$u.error("u-index-anchor必须要搭配u-index-list组件使用");t.anchors.push(this);const e=uni.$u.$parent.call(this,"u-index-item");if(!e)return uni.$u.error("u-index-anchor必须要搭配u-index-item组件使用");e.id=this.text.charCodeAt(0)}}},[["render",function(t,d,c,h,p,m){const f=u,x=l;return e(),i(x,{class:"u-index-anchor u-border-bottom",ref:`u-index-anchor-${t.text}`,style:o({height:t.$u.addUnit(t.height),backgroundColor:t.bgColor})},{default:s((()=>[n(f,{class:"u-index-anchor__text",style:o({fontSize:t.$u.addUnit(t.size),color:t.color})},{default:s((()=>[r(a(t.text),1)])),_:1},8,["style"])])),_:1},8,["style"])}],["__scopeId","data-v-0c33f323"]]);const H=w({name:"u-index-item",mixins:[y,L,{props:{}}],data:()=>({top:0,height:0,id:""}),created(){this.anchor={}},mounted(){this.init()},methods:{init(){if(this.getParentData("u-index-list"),!this.parent)return uni.$u.error("u-index-item必须要搭配u-index-list组件使用");uni.$u.sleep().then((()=>{this.getIndexItemRect().then((t=>{this.top=Math.ceil(t.top),this.height=Math.ceil(t.height)}))}))},getIndexItemRect(){return new Promise((t=>{this.$uGetRect(".u-index-item").then((e=>{t(e)}))}))}}},[["render",function(t,n,o,r,a,u){const h=l;return e(),i(h,{class:c(["u-index-item",[`u-index-item-${a.id}`]]),id:`u-index-item-${a.id}`},{default:s((()=>[d(t.$slots,"default",{},void 0,!0)])),_:3},8,["id","class"])}],["__scopeId","data-v-1820675a"]]),T={props:{inactiveColor:{type:String,default:()=>uni.$u.props.indexList.inactiveColor},activeColor:{type:String,default:()=>uni.$u.props.indexList.activeColor},indexList:{type:Array,default:()=>uni.$u.props.indexList.indexList},sticky:{type:Boolean,default:()=>uni.$u.props.indexList.sticky},customNavHeight:{type:[String,Number],default:()=>uni.$u.props.indexList.customNavHeight}}};const S=w({name:"u-index-list",mixins:[y,L,T],data:()=>({activeIndex:-1,touchmoveIndex:1,letterInfo:{height:0,itemHeight:0,top:0},indicatorHeight:50,touching:!1,scrollTop:0,scrollViewHeight:0,sys:uni.$u.sys(),scrolling:!1,scrollIntoView:""}),computed:{uIndexList(){return this.indexList.length?this.indexList:(()=>{const t=[],e="A".charCodeAt(0);for(let i=0;i<26;i++)t.push(String.fromCharCode(e+i));return t})()},indicatorTop(){const{top:t,itemHeight:e}=this.letterInfo;return Math.floor(t+e*this.activeIndex+e/2-this.indicatorHeight/2)}},watch:{uIndexList:{immediate:!0,handler(){uni.$u.sleep().then((()=>{this.setIndexListLetterInfo()}))}}},created(){this.children=[],this.anchors=[],this.init()},mounted(){this.setIndexListLetterInfo()},methods:{init(){let t=uni.$u.getPx(this.customNavHeight);this.scrollViewHeight=this.sys.windowHeight-t},touchStart(t){const e=t.changedTouches[0];if(!e)return;this.touching=!0;const{pageY:i}=e,s=this.getIndexListLetter(i);this.setValueForTouch(s)},touchMove(t){let e=t.changedTouches[0];if(!e)return;this.touching||(this.touching=!0);const{pageY:i}=e,s=this.getIndexListLetter(i);this.setValueForTouch(s)},touchEnd(t){uni.$u.sleep(300).then((()=>{this.touching=!1}))},getIndexListLetterRect(){return new Promise((t=>{this.$uGetRect(".u-index-list__letter").then((e=>{t(e)}))}))},setIndexListLetterInfo(){this.getIndexListLetterRect().then((t=>{const{height:e}=t,i=uni.$u.sys(),s=i.windowHeight;let n=0;n=0==this.customNavHeight?i.windowTop:uni.$u.getPx(this.customNavHeight),this.letterInfo={height:e,top:(s-e)/2+n/2,itemHeight:Math.floor(e/this.uIndexList.length)}}))},getIndexListLetter(t){const{top:e,height:i,itemHeight:s}=this.letterInfo;return(t+=uni.$u.sys().windowTop)<e?0:t>=e+i?this.uIndexList.length-1:Math.floor((t-e)/s)},setValueForTouch(t){t!==this.activeIndex&&(this.activeIndex=t,this.scrollIntoView=`u-index-item-${this.uIndexList[t].charCodeAt(0)}`)},getHeaderRect(){return new Promise((t=>{dom.getComponentRect(this.$refs.header,(e=>{t(e.size)}))}))},async scrollHandler(t){if(this.touching||this.scrolling)return;this.scrolling=!0,uni.$u.sleep(10).then((()=>{this.scrolling=!1}));let e=0;const i=this.children.length;let s=this.children;this.anchors,e=t.detail.scrollTop;for(let n=0;n<i;n++){const t=s[n],o=s[n+1];if(e<=s[0].top||e>=s[i-1].top+s[i-1].height){this.activeIndex=-1;break}if(!o){this.activeIndex=i-1;break}if(e>t.top&&e<o.top){this.activeIndex=n;break}}}}},[["render",function(t,v,$,y,L,w){const C=l,H=g,T=u,S=I(h("u-transition"),b);return e(),i(C,{class:"u-index-list"},{default:s((()=>[n(H,{scrollTop:L.scrollTop,scrollIntoView:L.scrollIntoView,"offset-accuracy":1,style:o({maxHeight:t.$u.addUnit(L.scrollViewHeight)}),"scroll-y":"",onScroll:w.scrollHandler,ref:"uList"},{default:s((()=>[t.$slots.header?(e(),i(C,{key:0},{default:s((()=>[d(t.$slots,"header",{},void 0,!0)])),_:3})):p("v-if",!0),d(t.$slots,"default",{},void 0,!0),t.$slots.footer?(e(),i(C,{key:1},{default:s((()=>[d(t.$slots,"footer",{},void 0,!0)])),_:3})):p("v-if",!0)])),_:3},8,["scrollTop","scrollIntoView","style","onScroll"]),n(C,{class:"u-index-list__letter",ref:"u-index-list__letter",style:o({top:t.$u.addUnit(L.letterInfo.top||100)}),onTouchstart:m(w.touchStart,["prevent"]),onTouchmove:m(w.touchMove,["prevent"]),onTouchend:m(w.touchEnd,["prevent"]),onTouchcancel:m(w.touchEnd,["prevent"])},{default:s((()=>[(e(!0),f(x,null,_(w.uIndexList,((u,l)=>(e(),i(C,{class:"u-index-list__letter__item",key:l,style:o({backgroundColor:L.activeIndex===l?t.activeColor:"transparent"})},{default:s((()=>[n(T,{class:"u-index-list__letter__item__index",style:o({color:L.activeIndex===l?"#fff":t.inactiveColor})},{default:s((()=>[r(a(u),1)])),_:2},1032,["style"])])),_:2},1032,["style"])))),128))])),_:1},8,["style","onTouchstart","onTouchmove","onTouchend","onTouchcancel"]),n(S,{mode:"fade",show:L.touching,customStyle:{position:"fixed",right:"50px",top:t.$u.addUnit(w.indicatorTop),zIndex:2}},{default:s((()=>[n(C,{class:c(["u-index-list__indicator",["u-index-list__indicator--show"]]),style:o({height:t.$u.addUnit(L.indicatorHeight),width:t.$u.addUnit(L.indicatorHeight)})},{default:s((()=>[n(T,{class:"u-index-list__indicator__text"},{default:s((()=>[r(a(w.uIndexList[L.activeIndex]),1)])),_:1})])),_:1},8,["style"])])),_:1},8,["show","customStyle"])])),_:3})}],["__scopeId","data-v-991eb7ec"]]),j=()=>{const t=[],e="A".charCodeAt(0);t.push("↑"),t.push("☆");for(let i=0;i<26;i++)t.push(String.fromCharCode(e+i));return t.push("#"),t};const z=w({data:()=>({indexList:j(),urls:["./static/uview/album/1.jpg","./static/uview/album/2.jpg","./static/uview/album/3.jpg","./static/uview/album/4.jpg","./static/uview/album/5.jpg","./static/uview/album/6.jpg","./static/uview/album/7.jpg","./static/uview/album/8.jpg","./static/uview/album/9.jpg","./static/uview/album/10.jpg"],names:["勇往无敌","疯狂的迪飙","磊爱可","梦幻梦幻梦","枫中飘瓢","飞翔天使","曾经第一","追风幻影族长","麦小姐","胡格罗雅","Red磊磊","乐乐立立","青龙爆风","跑跑卡叮车","山里狼","supersonic超"]}),computed:{itemArr(){return this.indexList.map((t=>{const e=[];for(let i=0;i<10;i++)e.push({name:this.names[uni.$u.random(0,this.names.length-1)],url:this.urls[uni.$u.random(0,this.urls.length-1)]});return e}))}}},[["render",function(o,d,c,p,m,g){const y=I(h("u-avatar"),t),L=u,w=l,b=I(h("u-line"),$),T=I(h("u-index-anchor"),C),j=v,z=I(h("u-index-item"),H),A=I(h("u-index-list"),S);return e(),i(A,{indexList:m.indexList},{default:s((()=>[n(w,{slot:"header",class:"list"},{default:s((()=>[n(w,{class:"list__item"},{default:s((()=>[n(y,{shape:"square",size:"35",icon:"man-add-fill",fontSize:"26",randomBgColor:""}),n(L,{class:"list__item__user-name"},{default:s((()=>[r("新的朋友")])),_:1})])),_:1}),n(b),n(w,{class:"list__item"},{default:s((()=>[n(y,{shape:"square",size:"35",icon:"tags-fill",fontSize:"26",randomBgColor:""}),n(L,{class:"list__item__user-name"},{default:s((()=>[r("标签")])),_:1})])),_:1}),n(b),n(w,{class:"list__item"},{default:s((()=>[n(y,{shape:"square",size:"35",icon:"chrome-circle-fill",fontSize:"26",randomBgColor:""}),n(L,{class:"list__item__user-name"},{default:s((()=>[r("朋友圈")])),_:1})])),_:1}),n(b),n(w,{class:"list__item"},{default:s((()=>[n(y,{shape:"square",size:"35",icon:"qq-fill",fontSize:"26",randomBgColor:""}),n(L,{class:"list__item__user-name"},{default:s((()=>[r("QQ")])),_:1})])),_:1}),n(b)])),_:1}),(e(!0),f(x,null,_(g.itemArr,((t,o)=>(e(),i(z,{key:o},{default:s((()=>[n(T,{text:m.indexList[o]},null,8,["text"]),(e(!0),f(x,null,_(t,((t,o)=>(e(),i(w,{class:"list",key:o},{default:s((()=>[n(w,{class:"list__item"},{default:s((()=>[n(j,{class:"list__item__avatar",src:t.url},null,8,["src"]),n(L,{class:"list__item__user-name"},{default:s((()=>[r(a(t.name),1)])),_:2},1024)])),_:2},1024),n(b)])),_:2},1024)))),128))])),_:2},1024)))),128)),n(w,{slot:"footer",class:"u-safe-area-inset--bottom"},{default:s((()=>[n(L,{class:"list__footer"},{default:s((()=>[r("共305位好友")])),_:1})])),_:1})])),_:1},8,["indexList"])}],["__scopeId","data-v-6d78a1bd"]]);export{z as default};
