import{d as t,o,c as e,w as i,a as s,p as l,n,g as p,t as a,f as u,b as r,F as d,r as c,h as _,i as h}from"./index-4f0c5e1d.js";import{_ as f}from"./u-overlay.f6da8b85.js";import{r as b}from"./uni-app.es.fcad82c0.js";import{_ as x}from"./u-line.0a9c4e0a.js";import{_ as y}from"./u-transition.589ae8d1.js";import{m,a as w}from"./mixin.d0c91ebc.js";import{_ as g}from"./_plugin-vue_export-helper.1b428a4d.js";const k=g({name:"u-tooltip",mixins:[m,w,{props:{text:{type:[String,Number],default:()=>uni.$u.props.tooltip.text},copyText:{type:[String,Number],default:()=>uni.$u.props.tooltip.copyText},size:{type:[String,Number],default:()=>uni.$u.props.tooltip.size},color:{type:String,default:()=>uni.$u.props.tooltip.color},bgColor:{type:String,default:()=>uni.$u.props.tooltip.bgColor},direction:{type:String,default:()=>uni.$u.props.tooltip.direction},zIndex:{type:[String,Number],default:()=>uni.$u.props.tooltip.zIndex},showCopy:{type:Boolean,default:()=>uni.$u.props.tooltip.showCopy},buttons:{type:Array,default:()=>uni.$u.props.tooltip.buttons},overlay:{type:Boolean,default:()=>uni.$u.props.tooltip.overlay},showToast:{type:Boolean,default:()=>uni.$u.props.tooltip.showToast}}}],data:()=>({showTooltip:!0,textId:uni.$u.guid(),tooltipId:uni.$u.guid(),tooltipTop:-1e4,tooltipInfo:{width:0,left:0},textInfo:{width:0,left:0},indicatorStyle:{},screenGap:12,indicatorWidth:14}),watch:{propsChange(){this.getElRect()}},computed:{propsChange(){return[this.text,this.buttons]},tooltipStyle(){const t={transform:`translateY(${"top"===this.direction?"-100%":"100%"})`},o=uni.$u.sys(),e=uni.$u.getPx,i=uni.$u.addUnit;if(this.tooltipInfo.width/2>this.textInfo.left+this.textInfo.width/2-this.screenGap)this.indicatorStyle={},t.left=`-${i(this.textInfo.left-this.screenGap)}`,this.indicatorStyle.left=i(this.textInfo.width/2-e(t.left)-this.indicatorWidth/2);else if(this.tooltipInfo.width/2>o.windowWidth-this.textInfo.right+this.textInfo.width/2-this.screenGap)this.indicatorStyle={},t.right=`-${i(o.windowWidth-this.textInfo.right-this.screenGap)}`,this.indicatorStyle.right=i(this.textInfo.width/2-e(t.right)-this.indicatorWidth/2);else{const o=Math.abs(this.textInfo.width/2-this.tooltipInfo.width/2);t.left=this.textInfo.width>this.tooltipInfo.width?i(o):-i(o),this.indicatorStyle={}}return"top"===this.direction?(t.marginTop="-10px",this.indicatorStyle.bottom="-4px"):(t.marginBottom="-10px",this.indicatorStyle.top="-4px"),t}},mounted(){this.init()},emits:["click"],methods:{init(){this.getElRect()},async longpressHandler(){this.tooltipTop=0,this.showTooltip=!0},overlayClickHandler(){this.showTooltip=!1},btnClickHandler(t){this.showTooltip=!1,this.$emit("click",this.showCopy?t+1:t)},queryRect(t){return new Promise((o=>{this.$uGetRect(`#${t}`).then((t=>{o(t)}))}))},getElRect(){this.showTooltip=!0,this.tooltipTop=-1e4,uni.$u.sleep(500).then((()=>{this.queryRect(this.tooltipId).then((t=>{this.tooltipInfo=t,this.showTooltip=!1})),this.queryRect(this.textId).then((t=>{this.textInfo=t}))}))},setClipboardData(){this.showTooltip=!1,this.$emit("click",0),uni.setClipboardData({data:this.copyText||this.text,success:()=>{this.showToast&&uni.$u.toast("复制成功")},fail:()=>{this.showToast&&uni.$u.toast("复制失败")},complete:()=>{this.showTooltip=!1}})}}},[["render",function(m,w,g,k,I,C){const $=b(t("u-overlay"),f),T=_,S=h,v=b(t("u-line"),x),j=b(t("u-transition"),y);return o(),e(S,{class:"u-tooltip",style:n([m.$u.addStyle(m.customStyle)])},{default:i((()=>[s($,{show:I.showTooltip&&-1e4!==I.tooltipTop&&m.overlay,customStyle:"backgroundColor: rgba(0, 0, 0, 0)",onClick:C.overlayClickHandler},null,8,["show","onClick"]),s(S,{class:"u-tooltip__wrapper"},{default:i((()=>[s(T,{class:"u-tooltip__wrapper__text",id:I.textId,ref:I.textId,userSelect:!1,selectable:!1,onLongpress:l(C.longpressHandler,["stop"]),style:n({color:m.color,backgroundColor:m.bgColor&&I.showTooltip&&-1e4!==I.tooltipTop?m.bgColor:"transparent"})},{default:i((()=>[p(a(m.text),1)])),_:1},8,["id","onLongpress","style"]),s(j,{mode:"fade",show:I.showTooltip,duration:"300",customStyle:{position:"absolute",top:m.$u.addUnit(I.tooltipTop),zIndex:m.zIndex,...C.tooltipStyle}},{default:i((()=>[s(S,{class:"u-tooltip__wrapper__popup",id:I.tooltipId,ref:I.tooltipId},{default:i((()=>[m.showCopy||m.buttons.length?(o(),e(S,{key:0,class:"u-tooltip__wrapper__popup__indicator","hover-class":"u-tooltip__wrapper__popup__indicator--hover",style:n([I.indicatorStyle,{width:m.$u.addUnit(I.indicatorWidth),height:m.$u.addUnit(I.indicatorWidth)}])},{default:i((()=>[u(" 由于nvue不支持三角形绘制，这里就做一个四方形，再旋转45deg，得到露出的一个三角 ")])),_:1},8,["style"])):u("v-if",!0),s(S,{class:"u-tooltip__wrapper__popup__list"},{default:i((()=>[m.showCopy?(o(),e(S,{key:0,class:"u-tooltip__wrapper__popup__list__btn","hover-class":"u-tooltip__wrapper__popup__list__btn--hover",onClick:C.setClipboardData},{default:i((()=>[s(T,{class:"u-tooltip__wrapper__popup__list__btn__text"},{default:i((()=>[p("复制")])),_:1})])),_:1},8,["onClick"])):u("v-if",!0),m.showCopy&&m.buttons.length>0?(o(),e(v,{key:1,direction:"column",color:"#8d8e90",length:"18"})):u("v-if",!0),(o(!0),r(d,null,c(m.buttons,((t,l)=>(o(),r(d,{key:l},[s(S,{class:"u-tooltip__wrapper__popup__list__btn","hover-class":"u-tooltip__wrapper__popup__list__btn--hover"},{default:i((()=>[s(T,{class:"u-tooltip__wrapper__popup__list__btn__text",onClick:t=>C.btnClickHandler(l)},{default:i((()=>[p(a(t),1)])),_:2},1032,["onClick"])])),_:2},1024),l<m.buttons.length-1?(o(),e(v,{key:0,direction:"column",color:"#8d8e90",length:"18"})):u("v-if",!0)],64)))),128))])),_:1})])),_:1},8,["id"])])),_:1},8,["show","customStyle"])])),_:1})])),_:1},8,["style"])}],["__scopeId","data-v-a2d0a050"]]);const I=g({data:()=>({text1:"长按文本，上方提示",text2:"长按文本，下方提示",text3:"显示多个扩展按钮",text4:"自动调整气泡位置",text5:"长按文本，显示背景色",buttons1:["扩展"],buttons2:["扩展","搜索","翻译"],buttons3:["扩展","搜索","翻译"]}),onLoad(){},methods:{click(t){console.log("index",t)}}},[["render",function(l,n,a,u,r,d){const c=_,f=b(t("u-tooltip"),k),x=h;return o(),e(x,{class:"u-page"},{default:i((()=>[s(x,{class:"u-demo-block"},{default:i((()=>[s(c,{class:"u-demo-block__title"},{default:i((()=>[p("基础使用")])),_:1}),s(x,{class:"u-demo-block__content"},{default:i((()=>[s(f,{text:r.text1,overlay:""},null,8,["text"])])),_:1})])),_:1}),s(x,{class:"u-demo-block"},{default:i((()=>[s(c,{class:"u-demo-block__title"},{default:i((()=>[p("下方显示")])),_:1}),s(x,{class:"u-demo-block__content",style:{"padding-bottom":"30px"}},{default:i((()=>[s(f,{text:r.text2,direction:"bottom"},null,8,["text"])])),_:1})])),_:1}),s(x,{class:"u-demo-block"},{default:i((()=>[s(c,{class:"u-demo-block__title"},{default:i((()=>[p("扩展按钮")])),_:1}),s(x,{class:"u-demo-block__content"},{default:i((()=>[s(f,{text:r.text3,buttons:r.buttons1,onClick:d.click},null,8,["text","buttons","onClick"])])),_:1})])),_:1}),s(x,{class:"u-demo-block"},{default:i((()=>[s(c,{class:"u-demo-block__title"},{default:i((()=>[p("自动调整位置")])),_:1}),s(x,{class:"u-demo-block__content"},{default:i((()=>[s(f,{text:r.text4,buttons:r.buttons2},null,8,["text","buttons"])])),_:1})])),_:1}),s(x,{class:"u-demo-block"},{default:i((()=>[s(c,{class:"u-demo-block__title"},{default:i((()=>[p("高亮选中文本背景色")])),_:1}),s(x,{class:"u-demo-block__content"},{default:i((()=>[s(f,{text:r.text5,buttons:r.buttons3,bgColor:"#e3e4e6"},null,8,["text","buttons"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-70ee2d55"]]);export{I as default};
