import{m as t,f as o,d as e,o as i,c as s,w as l,a as n,s as p,n as a,j as u,t as r,l as d,b as c,F as _,r as h,k as f,i as b}from"./index-d6cdb2d3.js";import{_ as y}from"./u-overlay.80aa3b20.js";import{r as x}from"./uni-app.es.9ca93cb4.js";import{_ as m}from"./u-line.071aa38e.js";import{_ as w}from"./u-transition.05456d56.js";import{_ as g}from"./_plugin-vue_export-helper.1b428a4d.js";const k=g({name:"u-tooltip",mixins:[t,o,{props:{text:{type:[String,Number],default:()=>uni.$u.props.tooltip.text},copyText:{type:[String,Number],default:()=>uni.$u.props.tooltip.copyText},size:{type:[String,Number],default:()=>uni.$u.props.tooltip.size},color:{type:String,default:()=>uni.$u.props.tooltip.color},bgColor:{type:String,default:()=>uni.$u.props.tooltip.bgColor},direction:{type:String,default:()=>uni.$u.props.tooltip.direction},zIndex:{type:[String,Number],default:()=>uni.$u.props.tooltip.zIndex},showCopy:{type:Boolean,default:()=>uni.$u.props.tooltip.showCopy},buttons:{type:Array,default:()=>uni.$u.props.tooltip.buttons},overlay:{type:Boolean,default:()=>uni.$u.props.tooltip.overlay},showToast:{type:Boolean,default:()=>uni.$u.props.tooltip.showToast}}}],data:()=>({showTooltip:!0,textId:uni.$u.guid(),tooltipId:uni.$u.guid(),tooltipTop:-1e4,tooltipInfo:{width:0,left:0},textInfo:{width:0,left:0},indicatorStyle:{},screenGap:12,indicatorWidth:14}),watch:{propsChange(){this.getElRect()}},computed:{propsChange(){return[this.text,this.buttons]},tooltipStyle(){const t={transform:`translateY(${"top"===this.direction?"-100%":"100%"})`},o=uni.$u.sys(),e=uni.$u.getPx,i=uni.$u.addUnit;if(this.tooltipInfo.width/2>this.textInfo.left+this.textInfo.width/2-this.screenGap)this.indicatorStyle={},t.left=`-${i(this.textInfo.left-this.screenGap)}`,this.indicatorStyle.left=i(this.textInfo.width/2-e(t.left)-this.indicatorWidth/2);else if(this.tooltipInfo.width/2>o.windowWidth-this.textInfo.right+this.textInfo.width/2-this.screenGap)this.indicatorStyle={},t.right=`-${i(o.windowWidth-this.textInfo.right-this.screenGap)}`,this.indicatorStyle.right=i(this.textInfo.width/2-e(t.right)-this.indicatorWidth/2);else{const o=Math.abs(this.textInfo.width/2-this.tooltipInfo.width/2);t.left=this.textInfo.width>this.tooltipInfo.width?i(o):-i(o),this.indicatorStyle={}}return"top"===this.direction?(t.marginTop="-10px",this.indicatorStyle.bottom="-4px"):(t.marginBottom="-10px",this.indicatorStyle.top="-4px"),t}},mounted(){this.init()},emits:["click"],methods:{init(){this.getElRect()},async longpressHandler(){this.tooltipTop=0,this.showTooltip=!0},overlayClickHandler(){this.showTooltip=!1},btnClickHandler(t){this.showTooltip=!1,this.$emit("click",this.showCopy?t+1:t)},queryRect(t){return new Promise((o=>{this.$uGetRect(`#${t}`).then((t=>{o(t)}))}))},getElRect(){this.showTooltip=!0,this.tooltipTop=-1e4,uni.$u.sleep(500).then((()=>{this.queryRect(this.tooltipId).then((t=>{this.tooltipInfo=t,this.showTooltip=!1})),this.queryRect(this.textId).then((t=>{this.textInfo=t}))}))},setClipboardData(){this.showTooltip=!1,this.$emit("click",0),uni.setClipboardData({data:this.copyText||this.text,success:()=>{this.showToast&&uni.$u.toast("复制成功")},fail:()=>{this.showToast&&uni.$u.toast("复制失败")},complete:()=>{this.showTooltip=!1}})}}},[["render",function(t,o,g,k,I,C){const $=x(e("u-overlay"),y),T=f,S=b,v=x(e("u-line"),m),j=x(e("u-transition"),w);return i(),s(S,{class:"u-tooltip",style:a([t.$u.addStyle(t.customStyle)])},{default:l((()=>[n($,{show:I.showTooltip&&-1e4!==I.tooltipTop&&t.overlay,customStyle:"backgroundColor: rgba(0, 0, 0, 0)",onClick:C.overlayClickHandler},null,8,["show","onClick"]),n(S,{class:"u-tooltip__wrapper"},{default:l((()=>[n(T,{class:"u-tooltip__wrapper__text",id:I.textId,ref:I.textId,userSelect:!1,selectable:!1,onLongpress:p(C.longpressHandler,["stop"]),style:a({color:t.color,backgroundColor:t.bgColor&&I.showTooltip&&-1e4!==I.tooltipTop?t.bgColor:"transparent"})},{default:l((()=>[u(r(t.text),1)])),_:1},8,["id","onLongpress","style"]),n(j,{mode:"fade",show:I.showTooltip,duration:"300",customStyle:{position:"absolute",top:t.$u.addUnit(I.tooltipTop),zIndex:t.zIndex,...C.tooltipStyle}},{default:l((()=>[n(S,{class:"u-tooltip__wrapper__popup",id:I.tooltipId,ref:I.tooltipId},{default:l((()=>[t.showCopy||t.buttons.length?(i(),s(S,{key:0,class:"u-tooltip__wrapper__popup__indicator","hover-class":"u-tooltip__wrapper__popup__indicator--hover",style:a([I.indicatorStyle,{width:t.$u.addUnit(I.indicatorWidth),height:t.$u.addUnit(I.indicatorWidth)}])},null,8,["style"])):d("",!0),n(S,{class:"u-tooltip__wrapper__popup__list"},{default:l((()=>[t.showCopy?(i(),s(S,{key:0,class:"u-tooltip__wrapper__popup__list__btn","hover-class":"u-tooltip__wrapper__popup__list__btn--hover",onClick:C.setClipboardData},{default:l((()=>[n(T,{class:"u-tooltip__wrapper__popup__list__btn__text"},{default:l((()=>[u("复制")])),_:1})])),_:1},8,["onClick"])):d("",!0),t.showCopy&&t.buttons.length>0?(i(),s(v,{key:1,direction:"column",color:"#8d8e90",length:"18"})):d("",!0),(i(!0),c(_,null,h(t.buttons,((o,e)=>(i(),c(_,{key:e},[n(S,{class:"u-tooltip__wrapper__popup__list__btn","hover-class":"u-tooltip__wrapper__popup__list__btn--hover"},{default:l((()=>[n(T,{class:"u-tooltip__wrapper__popup__list__btn__text",onClick:t=>C.btnClickHandler(e)},{default:l((()=>[u(r(o),1)])),_:2},1032,["onClick"])])),_:2},1024),e<t.buttons.length-1?(i(),s(v,{key:0,direction:"column",color:"#8d8e90",length:"18"})):d("",!0)],64)))),128))])),_:1})])),_:1},8,["id"])])),_:1},8,["show","customStyle"])])),_:1})])),_:1},8,["style"])}],["__scopeId","data-v-a2d0a050"]]);const I=g({data:()=>({text1:"长按文本，上方提示",text2:"长按文本，下方提示",text3:"显示多个扩展按钮",text4:"自动调整气泡位置",text5:"长按文本，显示背景色",buttons1:["扩展"],buttons2:["扩展","搜索","翻译"],buttons3:["扩展","搜索","翻译"]}),onLoad(){},methods:{click(t){console.log("index",t)}}},[["render",function(t,o,p,a,r,d){const c=f,_=x(e("up-tooltip"),k),h=b;return i(),s(h,{class:"u-page"},{default:l((()=>[n(h,{class:"u-demo-block"},{default:l((()=>[n(c,{class:"u-demo-block__title"},{default:l((()=>[u("基础使用")])),_:1}),n(h,{class:"u-demo-block__content"},{default:l((()=>[n(_,{text:r.text1,overlay:""},null,8,["text"])])),_:1})])),_:1}),n(h,{class:"u-demo-block"},{default:l((()=>[n(c,{class:"u-demo-block__title"},{default:l((()=>[u("下方显示")])),_:1}),n(h,{class:"u-demo-block__content",style:{"padding-bottom":"30px"}},{default:l((()=>[n(_,{text:r.text2,direction:"bottom"},null,8,["text"])])),_:1})])),_:1}),n(h,{class:"u-demo-block"},{default:l((()=>[n(c,{class:"u-demo-block__title"},{default:l((()=>[u("扩展按钮")])),_:1}),n(h,{class:"u-demo-block__content"},{default:l((()=>[n(_,{text:r.text3,buttons:r.buttons1,onClick:d.click},null,8,["text","buttons","onClick"])])),_:1})])),_:1}),n(h,{class:"u-demo-block"},{default:l((()=>[n(c,{class:"u-demo-block__title"},{default:l((()=>[u("自动调整位置")])),_:1}),n(h,{class:"u-demo-block__content"},{default:l((()=>[n(_,{text:r.text4,buttons:r.buttons2},null,8,["text","buttons"])])),_:1})])),_:1}),n(h,{class:"u-demo-block"},{default:l((()=>[n(c,{class:"u-demo-block__title"},{default:l((()=>[u("高亮选中文本背景色")])),_:1}),n(h,{class:"u-demo-block__content"},{default:l((()=>[n(_,{text:r.text5,buttons:r.buttons3,bgColor:"#e3e4e6"},null,8,["text","buttons"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-0b7ee874"]]);export{I as default};
