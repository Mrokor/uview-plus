import{d as e,o as t,c as s,w as i,a as r,k as a,b as l,F as n,r as o,l as u,n as d,g as p,t as c,h,i as _,x as b}from"./index-4f0c5e1d.js";import{_ as g}from"./u-badge.17911d23.js";import{r as m}from"./uni-app.es.fcad82c0.js";import{m as f,a as y}from"./mixin.d0c91ebc.js";import{_ as w}from"./_plugin-vue_export-helper.1b428a4d.js";const v=w({name:"u-tabs",mixins:[f,y,{props:{duration:{type:Number,default:()=>uni.$u.props.tabs.duration},list:{type:Array,default:()=>uni.$u.props.tabs.list},lineColor:{type:String,default:()=>uni.$u.props.tabs.lineColor},activeStyle:{type:[String,Object],default:()=>uni.$u.props.tabs.activeStyle},inactiveStyle:{type:[String,Object],default:()=>uni.$u.props.tabs.inactiveStyle},lineWidth:{type:[String,Number],default:()=>uni.$u.props.tabs.lineWidth},lineHeight:{type:[String,Number],default:()=>uni.$u.props.tabs.lineHeight},lineBgSize:{type:String,default:()=>uni.$u.props.tabs.lineBgSize},itemStyle:{type:[String,Object],default:()=>uni.$u.props.tabs.itemStyle},scrollable:{type:Boolean,default:()=>uni.$u.props.tabs.scrollable},current:{type:[Number,String],default:()=>uni.$u.props.tabs.current},keyName:{type:String,default:()=>uni.$u.props.tabs.keyName}}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(e,t){e!==this.innerCurrent&&(this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return e=>{const t={},s=e===this.innerCurrent?uni.$u.addStyle(this.activeStyle):uni.$u.addStyle(this.inactiveStyle);return this.list[e].disabled&&(t.color="#c8c9cc"),uni.$u.deepMerge(s,t)}},propsBadge:()=>uni.$u.props.badge},async mounted(){this.init()},emits:["click","change"],methods:{setLineLeft(){const e=this.list[this.innerCurrent];if(!e)return;let t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0);const s=uni.$u.getPx(this.lineWidth);this.lineOffsetLeft=t+(e.rect.width-s)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),10)},animation(e,t=0){},clickHandler(e,t){this.$emit("click",{...e,index:t}),e.disabled||(this.innerCurrent=t,this.resize(),this.$emit("change",{...e,index:t}))},init(){uni.$u.sleep().then((()=>{this.resize()}))},setScrollLeft(){const e=this.list[this.innerCurrent],t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=uni.$u.sys().windowWidth;let i=t-(this.tabsRect.width-e.rect.width)/2-(s-this.tabsRect.right)/2+this.tabsRect.left/2;i=Math.min(i,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,i)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([e,t=[]])=>{this.tabsRect=e,this.scrollViewWidth=0,t.map(((e,t)=>{this.scrollViewWidth+=e.width,this.list[t].rect=e})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((e=>{this.queryRect("u-tabs__wrapper__scroll-view").then((t=>e(t)))}))},getAllItemRect(){return new Promise((e=>{const t=this.list.map(((e,t)=>this.queryRect(`u-tabs__wrapper__nav__item-${t}`,!0)));Promise.all(t).then((t=>e(t)))}))},queryRect(e,t){return new Promise((t=>{this.$uGetRect(`.${e}`).then((e=>{t(e)}))}))}}},[["render",function(f,y,w,v,$,S){const x=h,C=m(e("u-badge"),g),k=_,B=b;return t(),s(k,{class:"u-tabs"},{default:i((()=>[r(k,{class:"u-tabs__wrapper"},{default:i((()=>[a(f.$slots,"left",{},void 0,!0),r(k,{class:"u-tabs__wrapper__scroll-view-wrapper"},{default:i((()=>[r(B,{"scroll-x":f.scrollable,"scroll-left":$.scrollLeft,"scroll-with-animation":"",class:"u-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"u-tabs__wrapper__scroll-view"},{default:i((()=>[r(k,{class:"u-tabs__wrapper__nav",ref:"u-tabs__wrapper__nav"},{default:i((()=>[(t(!0),l(n,null,o(f.list,((e,a)=>(t(),s(k,{class:u(["u-tabs__wrapper__nav__item",[`u-tabs__wrapper__nav__item-${a}`,e.disabled&&"u-tabs__wrapper__nav__item--disabled"]]),key:a,onClick:t=>S.clickHandler(e,a),ref_for:!0,ref:`u-tabs__wrapper__nav__item-${a}`,style:d([f.$u.addStyle(f.itemStyle),{flex:f.scrollable?"":1}])},{default:i((()=>[r(x,{class:u([[e.disabled&&"u-tabs__wrapper__nav__item__text--disabled"],"u-tabs__wrapper__nav__item__text"]),style:d([S.textStyle(a)])},{default:i((()=>[p(c(e[f.keyName]),1)])),_:2},1032,["class","style"]),r(C,{show:!(!e.badge||!(e.badge.show||e.badge.isDot||e.badge.value)),isDot:e.badge&&e.badge.isDot||S.propsBadge.isDot,value:e.badge&&e.badge.value||S.propsBadge.value,max:e.badge&&e.badge.max||S.propsBadge.max,type:e.badge&&e.badge.type||S.propsBadge.type,showZero:e.badge&&e.badge.showZero||S.propsBadge.showZero,bgColor:e.badge&&e.badge.bgColor||S.propsBadge.bgColor,color:e.badge&&e.badge.color||S.propsBadge.color,shape:e.badge&&e.badge.shape||S.propsBadge.shape,numberType:e.badge&&e.badge.numberType||S.propsBadge.numberType,inverted:e.badge&&e.badge.inverted||S.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),r(k,{class:"u-tabs__wrapper__nav__line",ref:"u-tabs__wrapper__nav__line",style:d([{width:f.$u.addUnit(f.lineWidth),transform:`translate(${$.lineOffsetLeft}px)`,transitionDuration:`${$.firstTime?0:f.duration}ms`,height:f.$u.addUnit(f.lineHeight),background:f.lineColor,backgroundSize:f.lineBgSize}])},null,8,["style"])])),_:1},512)])),_:1},8,["scroll-x","scroll-left"])])),_:1}),a(f.$slots,"right",{},void 0,!0)])),_:3})])),_:3})}],["__scopeId","data-v-041e85cd"]]);export{v as _};
