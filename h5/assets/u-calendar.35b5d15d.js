import{m as e,h as t,o as a,c as b,w as s,f,t as n,l as r,a as c,g as o,i as d,b as i,F as l,r as h,p as u,n as m,j as p,d as y,k as g,C as _}from"./index-5ac367f5.js";import{_ as D}from"./u-button.dc8231cb.js";import{r as w}from"./uni-app.es.addfbfcf.js";import{_ as x}from"./u-popup.600d85fb.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import{d as S}from"./index.a605aec4.js";const Y=M({name:"u-calendar-header",mixins:[e,t],props:{title:{type:String,default:""},subtitle:{type:String,default:""},showTitle:{type:Boolean,default:!0},showSubtitle:{type:Boolean,default:!0}},data:()=>({}),methods:{name(){}}},[["render",function(e,t,i,l,h,u){const m=o,p=d;return a(),b(p,{class:"u-calendar-header u-border-bottom"},{default:s((()=>[i.showTitle?(a(),b(m,{key:0,class:"u-calendar-header__title"},{default:s((()=>[f(n(i.title),1)])),_:1})):r("",!0),i.showSubtitle?(a(),b(m,{key:1,class:"u-calendar-header__subtitle"},{default:s((()=>[f(n(i.subtitle),1)])),_:1})):r("",!0),c(p,{class:"u-calendar-header__weekdays"},{default:s((()=>[c(m,{class:"u-calendar-header__weekdays__weekday"},{default:s((()=>[f("一")])),_:1}),c(m,{class:"u-calendar-header__weekdays__weekday"},{default:s((()=>[f("二")])),_:1}),c(m,{class:"u-calendar-header__weekdays__weekday"},{default:s((()=>[f("三")])),_:1}),c(m,{class:"u-calendar-header__weekdays__weekday"},{default:s((()=>[f("四")])),_:1}),c(m,{class:"u-calendar-header__weekdays__weekday"},{default:s((()=>[f("五")])),_:1}),c(m,{class:"u-calendar-header__weekdays__weekday"},{default:s((()=>[f("六")])),_:1}),c(m,{class:"u-calendar-header__weekdays__weekday"},{default:s((()=>[f("日")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-16556eaa"]]),$={name:"u-calendar-month",mixins:[e,t],props:{showMark:{type:Boolean,default:!0},color:{type:String,default:"#3c9cff"},months:{type:Array,default:()=>[]},mode:{type:String,default:"single"},rowHeight:{type:[String,Number],default:58},maxCount:{type:[String,Number],default:1/0},startText:{type:String,default:"开始"},endText:{type:String,default:"结束"},defaultDate:{type:[Array,String,Date],default:null},minDate:{type:[String,Number],default:0},maxDate:{type:[String,Number],default:0},maxMonth:{type:[String,Number],default:2},readonly:{type:Boolean,default:()=>uni.$u.props.calendar.readonly},maxRange:{type:[Number,String],default:1/0},rangePrompt:{type:String,default:""},showRangePrompt:{type:Boolean,default:!0},allowSameDay:{type:Boolean,default:!1}},data:()=>({width:0,item:{},selected:[]}),watch:{selectedChange:{immediate:!0,handler(e){this.setDefaultDate()}}},computed:{selectedChange(){return[this.minDate,this.maxDate,this.defaultDate]},dayStyle(e,t,a){return(e,t,a)=>{const b={};let s=a.week;const f=Number(parseFloat(this.width/7).toFixed(3).slice(0,-1));return b.height=uni.$u.addUnit(this.rowHeight),0===t&&(s=(0===s?7:s)-1,b.marginLeft=uni.$u.addUnit(s*f)),"range"===this.mode&&(b.paddingLeft=0,b.paddingRight=0,b.paddingBottom=0,b.paddingTop=0),b}},daySelectStyle(){return(e,t,a)=>{let b=S(a.date).format("YYYY-MM-DD"),s={};if(this.selected.some((e=>this.dateSame(e,b)))&&(s.backgroundColor=this.color),"single"===this.mode)b===this.selected[0]&&(s.borderTopLeftRadius="3px",s.borderBottomLeftRadius="3px",s.borderTopRightRadius="3px",s.borderBottomRightRadius="3px");else if("range"===this.mode)if(this.selected.length>=2){const e=this.selected.length-1;this.dateSame(b,this.selected[0])&&(s.borderTopLeftRadius="3px",s.borderBottomLeftRadius="3px"),this.dateSame(b,this.selected[e])&&(s.borderTopRightRadius="3px",s.borderBottomRightRadius="3px"),S(b).isAfter(S(this.selected[0]))&&S(b).isBefore(S(this.selected[e]))&&(s.backgroundColor=uni.$u.colorGradient(this.color,"#ffffff",100)[90],s.opacity=.7)}else 1===this.selected.length&&(s.borderTopLeftRadius="3px",s.borderBottomLeftRadius="3px");else this.selected.some((e=>this.dateSame(e,b)))&&(s.borderTopLeftRadius="3px",s.borderBottomLeftRadius="3px",s.borderTopRightRadius="3px",s.borderBottomRightRadius="3px");return s}},textStyle(){return e=>{const t=S(e.date).format("YYYY-MM-DD"),a={};if(this.selected.some((e=>this.dateSame(e,t)))&&(a.color="#ffffff"),"range"===this.mode){const e=this.selected.length-1;S(t).isAfter(S(this.selected[0]))&&S(t).isBefore(S(this.selected[e]))&&(a.color=this.color)}return a}},getBottomInfo(){return(e,t,a)=>{const b=S(a.date).format("YYYY-MM-DD"),s=a.bottomInfo;if("range"===this.mode&&this.selected.length>0){if(1===this.selected.length)return this.dateSame(b,this.selected[0])?this.startText:s;{const e=this.selected.length-1;return this.dateSame(b,this.selected[0])&&this.dateSame(b,this.selected[1])&&1===e?`${this.startText}/${this.endText}`:this.dateSame(b,this.selected[0])?this.startText:this.dateSame(b,this.selected[e])?this.endText:s}}return s}}},mounted(){this.init()},methods:{init(){this.$emit("monthSelected",this.selected),this.$nextTick((()=>{uni.$u.sleep(10).then((()=>{this.getWrapperWidth(),this.getMonthRect()}))}))},dateSame:(e,t)=>S(e).isSame(S(t)),getWrapperWidth(){this.$uGetRect(".u-calendar-month-wrapper").then((e=>{this.width=e.width}))},getMonthRect(){const e=this.months.map(((e,t)=>this.getMonthRectByPromise(`u-calendar-month-${t}`)));Promise.all(e).then((e=>{let t=1;const a=[];for(let b=0;b<this.months.length;b++)a[b]=t,t+=e[b].height;this.$emit("updateMonthTop",a)}))},getMonthRectByPromise(e){return new Promise((t=>{this.$uGetRect(`.${e}`).then((e=>{t(e)}))}))},clickHandler(e,t,a){if(this.readonly)return;this.item=a;const b=S(a.date).format("YYYY-MM-DD");if(a.disabled)return;let s=uni.$u.deepClone(this.selected);if("single"===this.mode)s=[b];else if("multiple"===this.mode)if(s.some((e=>this.dateSame(e,b)))){const e=s.findIndex((e=>e===b));s.splice(e,1)}else s.length<this.maxCount&&s.push(b);else if(0===s.length||s.length>=2)s=[b];else if(1===s.length){const e=s[0];if(S(b).isBefore(e))s=[b];else if(S(b).isAfter(e)){if(S(S(b).subtract(this.maxRange,"day")).isAfter(S(s[0]))&&this.showRangePrompt)return void(this.rangePrompt?uni.$u.toast(this.rangePrompt):uni.$u.toast(`选择天数不能超过 ${this.maxRange} 天`));s.push(b);const e=s[0],t=s[1],a=[];let f=0;do{a.push(S(e).add(f,"day").format("YYYY-MM-DD")),f++}while(S(e).add(f,"day").isBefore(S(t)));a.push(t),s=a}else{if(s[0]===b&&!this.allowSameDay)return;s.push(b)}}this.setSelected(s)},setDefaultDate(){if(!this.defaultDate){const e=[S().format("YYYY-MM-DD")];return this.setSelected(e,!1)}let e=[];const t=this.minDate||S().format("YYYY-MM-DD"),a=this.maxDate||S(t).add(this.maxMonth-1,"month").format("YYYY-MM-DD");if("single"===this.mode)e=uni.$u.test.array(this.defaultDate)?[this.defaultDate[0]]:[S(this.defaultDate).format("YYYY-MM-DD")];else{if(!uni.$u.test.array(this.defaultDate))return;e=this.defaultDate}e=e.filter((e=>S(e).isAfter(S(t).subtract(1,"day"))&&S(e).isBefore(S(a).add(1,"day")))),this.setSelected(e,!1)},setSelected(e,t=!0){this.selected=e,t&&this.$emit("monthSelected",this.selected,"tap")}}};const T={props:{title:{type:String,default:()=>uni.$u.props.calendar.title},showTitle:{type:Boolean,default:()=>uni.$u.props.calendar.showTitle},showSubtitle:{type:Boolean,default:()=>uni.$u.props.calendar.showSubtitle},mode:{type:String,default:()=>uni.$u.props.calendar.mode},startText:{type:String,default:()=>uni.$u.props.calendar.startText},endText:{type:String,default:()=>uni.$u.props.calendar.endText},customList:{type:Array,default:()=>uni.$u.props.calendar.customList},color:{type:String,default:()=>uni.$u.props.calendar.color},minDate:{type:[String,Number],default:()=>uni.$u.props.calendar.minDate},maxDate:{type:[String,Number],default:()=>uni.$u.props.calendar.maxDate},defaultDate:{type:[Array,String,Date,null],default:()=>uni.$u.props.calendar.defaultDate},maxCount:{type:[String,Number],default:()=>uni.$u.props.calendar.maxCount},rowHeight:{type:[String,Number],default:()=>uni.$u.props.calendar.rowHeight},formatter:{type:[Function,null],default:()=>uni.$u.props.calendar.formatter},showLunar:{type:Boolean,default:()=>uni.$u.props.calendar.showLunar},showMark:{type:Boolean,default:()=>uni.$u.props.calendar.showMark},confirmText:{type:String,default:()=>uni.$u.props.calendar.confirmText},confirmDisabledText:{type:String,default:()=>uni.$u.props.calendar.confirmDisabledText},show:{type:Boolean,default:()=>uni.$u.props.calendar.show},closeOnClickOverlay:{type:Boolean,default:()=>uni.$u.props.calendar.closeOnClickOverlay},readonly:{type:Boolean,default:()=>uni.$u.props.calendar.readonly},showConfirm:{type:Boolean,default:()=>uni.$u.props.calendar.showConfirm},maxRange:{type:[Number,String],default:()=>uni.$u.props.calendar.maxRange},rangePrompt:{type:String,default:()=>uni.$u.props.calendar.rangePrompt},showRangePrompt:{type:Boolean,default:()=>uni.$u.props.calendar.showRangePrompt},allowSameDay:{type:Boolean,default:()=>uni.$u.props.calendar.allowSameDay},round:{type:[Boolean,String,Number],default:()=>uni.$u.props.calendar.round},monthNum:{type:[Number,String],default:3}}};var k={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,41696,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],solarTerm:["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["日","一","二","三","四","五","六","七","八","九","十"],nStr2:["初","十","廿","卅"],nStr3:["正","二","三","四","五","六","七","八","九","十","冬","腊"],lYearDays:function(e){var t,a=348;for(t=32768;t>8;t>>=1)a+=this.lunarInfo[e-1900]&t?1:0;return a+this.leapDays(e)},leapMonth:function(e){return 15&this.lunarInfo[e-1900]},leapDays:function(e){return this.leapMonth(e)?65536&this.lunarInfo[e-1900]?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;var a=t-1;return 1==a?e%4==0&&e%100!=0||e%400==0?29:28:this.solarMonth[a]},toGanZhiYear:function(e){var t=(e-3)%10,a=(e-3)%12;return 0==t&&(t=10),0==a&&(a=12),this.Gan[t-1]+this.Zhi[a-1]},toAstro:function(e,t){return"魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯".substr(2*e-(t<[20,19,21,21,21,22,23,23,23,23,22,22][e-1]?2:0),2)+"座"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100)return-1;if(t<1||t>24)return-1;var a=this.sTermInfo[e-1900],b=[parseInt("0x"+a.substr(0,5)).toString(),parseInt("0x"+a.substr(5,5)).toString(),parseInt("0x"+a.substr(10,5)).toString(),parseInt("0x"+a.substr(15,5)).toString(),parseInt("0x"+a.substr(20,5)).toString(),parseInt("0x"+a.substr(25,5)).toString()],s=[b[0].substr(0,1),b[0].substr(1,2),b[0].substr(3,1),b[0].substr(4,2),b[1].substr(0,1),b[1].substr(1,2),b[1].substr(3,1),b[1].substr(4,2),b[2].substr(0,1),b[2].substr(1,2),b[2].substr(3,1),b[2].substr(4,2),b[3].substr(0,1),b[3].substr(1,2),b[3].substr(3,1),b[3].substr(4,2),b[4].substr(0,1),b[4].substr(1,2),b[4].substr(3,1),b[4].substr(4,2),b[5].substr(0,1),b[5].substr(1,2),b[5].substr(3,1),b[5].substr(4,2)];return parseInt(s[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;var t=this.nStr3[e-1];return t+="月"},toChinaDay:function(e){var t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,a){if(e<1900||e>2100)return-1;if(1900==e&&1==t&&a<31)return-1;if(e)b=new Date(e,parseInt(t)-1,a);else var b=new Date;var s,f=0,n=(e=b.getFullYear(),t=b.getMonth()+1,a=b.getDate(),(Date.UTC(b.getFullYear(),b.getMonth(),b.getDate())-Date.UTC(1900,0,31))/864e5);for(s=1900;s<2101&&n>0;s++)n-=f=this.lYearDays(s);n<0&&(n+=f,s--);var r=new Date,c=!1;r.getFullYear()==e&&r.getMonth()+1==t&&r.getDate()==a&&(c=!0);var o=b.getDay(),d=this.nStr1[o];0==o&&(o=7);var i=s,l=this.leapMonth(s),h=!1;for(s=1;s<13&&n>0;s++)l>0&&s==l+1&&0==h?(--s,h=!0,f=this.leapDays(i)):f=this.monthDays(i,s),1==h&&s==l+1&&(h=!1),n-=f;0==n&&l>0&&s==l+1&&(h?h=!1:(h=!0,--s)),n<0&&(n+=f,--s);var u=s,m=n+1,p=t-1,y=this.toGanZhiYear(i),g=this.getTerm(e,2*t-1),_=this.getTerm(e,2*t),D=this.toGanZhi(12*(e-1900)+t+11);a>=g&&(D=this.toGanZhi(12*(e-1900)+t+12));var w=!1,x=null;g==a&&(w=!0,x=this.solarTerm[2*t-2]),_==a&&(w=!0,x=this.solarTerm[2*t-1]);var M=Date.UTC(e,p,1,0,0,0,0)/864e5+25567+10,S=this.toGanZhi(M+a-1),Y=this.toAstro(t,a);return{lYear:i,lMonth:u,lDay:m,Animal:this.getAnimal(i),IMonthCn:(h?"闰":"")+this.toChinaMonth(u),IDayCn:this.toChinaDay(m),cYear:e,cMonth:t,cDay:a,gzYear:y,gzMonth:D,gzDay:S,isToday:c,isLeap:h,nWeek:o,ncWeek:"星期"+d,isTerm:w,Term:x,astro:Y}},lunar2solar:function(e,t,a,b){b=!!b;var s=this.leapMonth(e);if(this.leapDays(e),b&&s!=t)return-1;if(2100==e&&12==t&&a>1||1900==e&&1==t&&a<31)return-1;var f=this.monthDays(e,t),n=f;if(b&&(n=this.leapDays(e,t)),e<1900||e>2100||a>n)return-1;for(var r=0,c=1900;c<e;c++)r+=this.lYearDays(c);var o=0,d=!1;for(c=1;c<t;c++)o=this.leapMonth(e),d||o<=c&&o>0&&(r+=this.leapDays(e),d=!0),r+=this.monthDays(e,c);b&&(r+=f);var i=Date.UTC(1900,1,30,0,0,0),l=new Date(864e5*(r+a-31)+i),h=l.getUTCFullYear(),u=l.getUTCMonth()+1,m=l.getUTCDate();return this.solar2lunar(h,u,m)}};const C=M({name:"u-calendar",mixins:[e,t,T],components:{uHeader:Y,uMonth:M($,[["render",function(e,t,p,y,g,_){const D=o,w=d;return a(),b(w,{class:"u-calendar-month-wrapper",ref:"u-calendar-month-wrapper"},{default:s((()=>[(a(!0),i(l,null,h(p.months,((e,t)=>(a(),b(w,{key:t,class:u([`u-calendar-month-${t}`]),ref_for:!0,ref:`u-calendar-month-${t}`,id:`month-${t}`},{default:s((()=>[0!==t?(a(),b(D,{key:0,class:"u-calendar-month__title"},{default:s((()=>[f(n(e.year)+"年"+n(e.month)+"月",1)])),_:2},1024)):r("",!0),c(w,{class:"u-calendar-month__days"},{default:s((()=>[p.showMark?(a(),b(w,{key:0,class:"u-calendar-month__days__month-mark-wrapper"},{default:s((()=>[c(D,{class:"u-calendar-month__days__month-mark-wrapper__text"},{default:s((()=>[f(n(e.month),1)])),_:2},1024)])),_:2},1024)):r("",!0),(a(!0),i(l,null,h(e.date,((e,o)=>(a(),b(w,{class:u(["u-calendar-month__days__day",[e.selected&&"u-calendar-month__days__day__select--selected"]]),key:o,style:m([_.dayStyle(t,o,e)]),onClick:a=>_.clickHandler(t,o,e)},{default:s((()=>[c(w,{class:"u-calendar-month__days__day__select",style:m([_.daySelectStyle(t,o,e)])},{default:s((()=>[c(D,{class:u(["u-calendar-month__days__day__select__info",[e.disabled&&"u-calendar-month__days__day__select__info--disabled"]]),style:m([_.textStyle(e)])},{default:s((()=>[f(n(e.day),1)])),_:2},1032,["class","style"]),_.getBottomInfo(t,o,e)?(a(),b(D,{key:0,class:u(["u-calendar-month__days__day__select__buttom-info",[e.disabled&&"u-calendar-month__days__day__select__buttom-info--disabled"]]),style:m([_.textStyle(e)])},{default:s((()=>[f(n(_.getBottomInfo(t,o,e)),1)])),_:2},1032,["class","style"])):r("",!0),e.dot?(a(),b(D,{key:1,class:"u-calendar-month__days__day__select__dot"})):r("",!0)])),_:2},1032,["style"])])),_:2},1032,["style","onClick","class"])))),128))])),_:2},1024)])),_:2},1032,["class","id"])))),128))])),_:1},512)}],["__scopeId","data-v-e6367071"]])},data:()=>({months:[],monthIndex:0,listHeight:0,selected:[],scrollIntoView:"",scrollTop:0,innerFormatter:e=>e}),watch:{selectedChange:{immediate:!0,handler(e){this.setMonth()}},show:{immediate:!0,handler(e){this.setMonth()}}},computed:{innerMaxDate(){return uni.$u.test.number(this.maxDate)?Number(this.maxDate):this.maxDate},innerMinDate(){return uni.$u.test.number(this.minDate)?Number(this.minDate):this.minDate},selectedChange(){return[this.innerMinDate,this.innerMaxDate,this.defaultDate]},subtitle(){return this.months.length?`${this.months[this.monthIndex].year}年${this.months[this.monthIndex].month}月`:""},buttonDisabled(){return"range"===this.mode&&this.selected.length<=1}},mounted(){this.start=Date.now(),this.init()},emits:["confirm","close"],methods:{setFormatter(e){this.innerFormatter=e},monthSelected(e,t="init"){if(this.selected=e,!this.showConfirm&&("multiple"===this.mode||"single"===this.mode||"range"===this.mode&&this.selected.length>=2)){if("init"===t)return;"tap"===t&&this.$emit("confirm",this.selected)}},init(){if(this.innerMaxDate&&new Date(this.innerMaxDate).getTime()<=Date.now())return uni.$u.error("maxDate不能小于当前时间");this.listHeight=5*this.rowHeight+30,this.setMonth()},close(){this.$emit("close")},confirm(){this.buttonDisabled||this.$emit("confirm",this.selected)},getMonths(e,t){const a=S(e).year(),b=S(e).month()+1;return 12*(S(t).year()-a)+(S(t).month()+1-b)+1},setMonth(){const e=this.innerMinDate||S().valueOf(),t=this.innerMaxDate||S(e).add(this.monthNum-1,"month").valueOf(),a=uni.$u.range(1,this.monthNum,this.getMonths(e,t));this.months=[];for(let b=0;b<a;b++)this.months.push({date:new Array(S(e).add(b,"month").daysInMonth()).fill(1).map(((a,s)=>{let f=s+1;const n=S(e).add(b,"month").date(f).day(),r=S(e).add(b,"month").date(f).format("YYYY-MM-DD");let c="";if(this.showLunar){c=k.solar2lunar(S(r).year(),S(r).month()+1,S(r).date()).IDayCn}let o={day:f,week:n,disabled:S(r).isBefore(S(e).format("YYYY-MM-DD"))||S(r).isAfter(S(t).format("YYYY-MM-DD")),date:new Date(r),bottomInfo:c,dot:!1,month:S(e).add(b,"month").month()+1};return(this.formatter||this.innerFormatter)(o)})),month:S(e).add(b,"month").month()+1,year:S(e).add(b,"month").year()})},scrollIntoDefaultMonth(e){const t=this.months.findIndex((({year:t,month:a})=>`${t}-${a=uni.$u.padZero(a)}`===e));-1!==t&&this.$nextTick((()=>{this.scrollIntoView=`month-${t}`}))},onScroll(e){const t=Math.max(0,e.detail.scrollTop);for(let a=0;a<this.months.length;a++)t>=(this.months[a].top||this.listHeight)&&(this.monthIndex=a)},updateMonthTop(e=[]){if(e.map(((e,t)=>{this.months[t].top=e})),!this.defaultDate){const e=S().format("YYYY-MM");return void this.scrollIntoDefaultMonth(e)}let t=S().format("YYYY-MM");t=uni.$u.test.array(this.defaultDate)?S(this.defaultDate[0]).format("YYYY-MM"):S(this.defaultDate).format("YYYY-MM"),this.scrollIntoDefaultMonth(t)}}},[["render",function(e,t,f,n,o,i){const l=p("uHeader"),h=p("uMonth"),u=_,M=w(y("u-button"),D),S=d,Y=w(y("u-popup"),x);return a(),b(Y,{show:e.show,mode:"bottom",closeable:"",onClose:i.close,round:e.round,closeOnClickOverlay:e.closeOnClickOverlay},{default:s((()=>[c(S,{class:"u-calendar"},{default:s((()=>[c(l,{title:e.title,subtitle:i.subtitle,showSubtitle:e.showSubtitle,showTitle:e.showTitle},null,8,["title","subtitle","showSubtitle","showTitle"]),c(u,{style:m({height:e.$u.addUnit(o.listHeight)}),"scroll-y":"",onScroll:i.onScroll,"scroll-top":o.scrollTop,scrollIntoView:o.scrollIntoView},{default:s((()=>[c(h,{color:e.color,rowHeight:e.rowHeight,showMark:e.showMark,months:o.months,mode:e.mode,maxCount:e.maxCount,startText:e.startText,endText:e.endText,defaultDate:e.defaultDate,minDate:i.innerMinDate,maxDate:i.innerMaxDate,maxMonth:e.monthNum,readonly:e.readonly,maxRange:e.maxRange,rangePrompt:e.rangePrompt,showRangePrompt:e.showRangePrompt,allowSameDay:e.allowSameDay,ref:"month",onMonthSelected:i.monthSelected,onUpdateMonthTop:i.updateMonthTop},null,8,["color","rowHeight","showMark","months","mode","maxCount","startText","endText","defaultDate","minDate","maxDate","maxMonth","readonly","maxRange","rangePrompt","showRangePrompt","allowSameDay","onMonthSelected","onUpdateMonthTop"])])),_:1},8,["style","onScroll","scroll-top","scrollIntoView"]),e.showConfirm?g(e.$slots,"footer",{key:0},(()=>[c(S,{class:"u-calendar__confirm"},{default:s((()=>[c(M,{shape:"circle",text:i.buttonDisabled?e.confirmDisabledText:e.confirmText,color:e.color,onClick:i.confirm,disabled:i.buttonDisabled},null,8,["text","color","onClick","disabled"])])),_:1})]),!0):r("",!0)])),_:3})])),_:3},8,["show","onClose","round","closeOnClickOverlay"])}],["__scopeId","data-v-f6c9abdb"]]);export{C as _};
